% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/v2g.R
\name{smart_v2g}
\alias{smart_v2g}
\title{Smart V2G algorithm}
\usage{
smart_v2g(
  sessions,
  opt_data,
  opt_objective = "grid",
  window_days,
  window_start_hour,
  responsive = NULL,
  power_th = 0,
  charging_power_min = 0,
  energy_min = 1,
  include_log = FALSE,
  show_progress = FALSE,
  lambda = 0
)
}
\arguments{
\item{sessions}{tibble, sessions data set containig the following variables:
\code{"Session"}, \code{"Timecycle"}, \code{"Profile"}, \code{"ConnectionStartDateTime"}, \code{"ConnectionHours"}, \code{"Power"} and \code{"Energy"}.}

\item{opt_data}{tibble, optimization contextual data.
The first column must be named \code{datetime} (mandatory) containing the
date time sequence where the smart charging algorithm is applied, so
only sessions starting within the time sequence of column \code{datetime}
will be optimized.
The other columns can be:
\itemize{
\item \code{static}: static power demand (in kW) from other sectors like buildings,
offices, etc.
\item \code{import_capacity}: maximum imported power from the grid (in kW),
for example the contracted power with the energy company.
\item \code{export_capacity}: maximum exported power from the grid (in kW),
for example the contracted power with the energy company.
\item \code{production}: local power generation (in kW).
This is used when \code{opt_objective = "grid"}.
\item \code{price_imported}: price for imported energy (Euro/kWh).
This is used when \code{opt_objective = "cost"}.
\item \code{price_exported}: price for exported energy (Euro/kWh).
This is used when \code{opt_objective = "cost"}.
\item \code{price_turn_down}: price for turn-down energy use (Euro/kWh).
This is used when \code{opt_objective = "cost"}.
\item \code{price_turn_up}: price for turn-up energy use (Euro/kWh).
This is used when \code{opt_objective = "cost"}.
}

If columns of \code{opt_data} are user profiles names, these are used as setpoints
and no optimization is performed for the corresponding user profiles.}

\item{opt_objective}{character, optimisation objective being
\code{"none"}, \code{"grid"}, \code{"cost"} or a value between 0 (cost)
and 1 (grid). Only the \code{"grid"} mode is currently supported
by the V2G prototype.}

\item{window_days}{integer, number of days to consider as optimization window.}

\item{window_start_hour}{integer, starting hour of the optimization window.}

\item{responsive}{Named two-level list with the ratio (between 0 and 1)
of sessions responsive to smart charging program.
The names of the list must exactly match the Time-cycle and User profiles names.
For example: \code{list(Monday = list(Worktime = 1, Shortstay = 0.1))}}

\item{power_th}{numeric, power threshold (between 0 and 1) accepted from setpoint.
For example, with \code{power_th = 0.1} and \code{setpoint = 100} for a certain time slot,
then sessions' demand can reach a value of \code{110} without needing to schedule sessions.}

\item{charging_power_min}{numeric. It can be configured in two ways:
(1) minimum allowed ratio (between 0 and 0.999) of nominal power (i.e. \code{Power} column in \code{sessions}), or
(2) specific value of minimum power (in kW) from 1 kW or higher.

For example, if \code{charging_power_min = 0.5} and \code{method = 'curtail'}, sessions' charging power can only
be curtailed until the 50\% of the nominal charging power.
And if \code{charging_power_min = 2}, sessions' charging power can be curtailed until 2 kW.}

\item{energy_min}{numeric, minimum allowed ratio (between 0 and 1) of required energy.}

\item{include_log}{logical, whether to output the algorithm messages for every user profile and time-slot}

\item{show_progress}{logical, whether to output the progress bar in the console}

\item{lambda}{numeric, penalty on change for the flexible load.}
}
\value{
list with setpoints, sessions and demand similar to
\code{smart_charging()}. Scheduling is still charging-only while
the V2G-specific session logic is under development.
}
\description{
Prototype vehicle-to-grid simulation built on top of \code{smart_charging()}
helpers. The current implementation mirrors the classic workflow
(responsiveness filtering, setpoint definition and scheduling placeholder)
but it isolates the new optimisation pieces so the existing API remains
untouched.
}
